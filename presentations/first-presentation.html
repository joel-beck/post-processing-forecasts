<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Post-Processing COVID-19 Forecasts</title>
    <meta charset="utf-8" />
    <meta name="author" content="Matthias Herp &amp; Joel Beck" />
    <script src="first-presentation_files/header-attrs/header-attrs.js"></script>
    <link href="first-presentation_files/tile-view/tile-view.css" rel="stylesheet" />
    <script src="first-presentation_files/tile-view/tile-view.js"></script>
    <link href="first-presentation_files/panelset/panelset.css" rel="stylesheet" />
    <script src="first-presentation_files/panelset/panelset.js"></script>
    <script src="first-presentation_files/mark.js/mark.min.js"></script>
    <link href="first-presentation_files/xaringanExtra-search/search.css" rel="stylesheet" />
    <script src="first-presentation_files/xaringanExtra-search/search.js"></script>
    <script>window.addEventListener('load', function() { window.xeSearch = new RemarkSearch({"position":"bottom-left","caseSensitive":false,"showIcon":false,"autoSearch":false}) })</script>
    <link href="first-presentation_files/tachyons/tachyons.min.css" rel="stylesheet" />
    <script src="first-presentation_files/xaringanExtra_fit-screen/fit-screen.js"></script>
    <link href="first-presentation_files/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script src="first-presentation_files/xaringanExtra-progressBar/progress-bar.js"></script>
    <script src="first-presentation_files/htmlwidgets/htmlwidgets.js"></script>
    <link href="first-presentation_files/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="first-presentation_files/datatables-binding/datatables.js"></script>
    <script src="first-presentation_files/jquery/jquery-3.6.0.min.js"></script>
    <link href="first-presentation_files/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="first-presentation_files/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="first-presentation_files/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="first-presentation_files/nouislider/jquery.nouislider.min.css" rel="stylesheet" />
    <script src="first-presentation_files/nouislider/jquery.nouislider.min.js"></script>
    <link href="first-presentation_files/selectize/selectize.bootstrap3.css" rel="stylesheet" />
    <script src="first-presentation_files/selectize/selectize.min.js"></script>
    <link href="first-presentation_files/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="first-presentation_files/crosstalk/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Post-Processing COVID-19 Forecasts
## - First Presentation -<br><br>
### Matthias Herp &amp; Joel Beck
### 10.12.2021

---

&lt;!-- here classes for second slide --&gt;


&lt;!-- General Layout &amp; Workflow --&gt;
&lt;!-- ----------------------------------------------------------------------- --&gt;

&lt;!-- 
build pdf slides with the xaringanBuilder package 
use e.g. xaringanBuilder::build_pdf(input = "file-path", partial_slides = TRUE, complex_slides = FALSE, keep_intermediates = TRUE) 
--&gt;

&lt;!-- 
Slide Classes:

- top, middle, bottom
- left, center, right
- inverse

- background-image: url(link)
- background-size: cover | contain
- background-position: center

- name
- template
- layout: true | false
- count: false
- seal: true | false (create title slide from YAML header)


Content Classes:

- .left[], .center[], .right[] (alignment)
- .left-column[], .right-column[] (positioning, unequal width)
- .pull-left[], .pull-right[] (positioning, equal width)
- .footnote[]
- .color[]
- custom classes defined in CSS code chunks, 
e.g. .tiny[], .small[], .medium[], .large[], .huge[]


Colors:
- Color Scheme Generator: https://coolors.co/
- Google Color Picker

Images:
- Background Images: https://unsplash.com/

Fonts:
- Google Fonts: https://fonts.google.com/

Emojis:
- Find Emoji Name: https://emojipedia.org/
- Use Ermoji Addin to get Unicode Symbol or R Code for emo package
- emo Package: https://github.com/hadley/emo 

Icons:
- icon Package: https://pkg.mitchelloharawild.com/icons/

Embedding:
- Images and Gifs: usual Markdown Syntax ![]() or html syntax &lt;iframe&gt;&lt;/iframe&gt;
- Youtube Videos: Click 'Teilen =&gt; Einbetten' below the video, can also control the starting time of the video
- Example: &lt;iframe width="800" height="400" src="link" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;

--&gt;


&lt;!-- Settings for xaringanthemer &amp; xaringanExtra --&gt;
&lt;!-- ----------------------------------------------------------------------- --&gt;




&lt;!-- CSS Classes taken from Garrick Aiden-Buie's Blog --&gt;
&lt;!-- ----------------------------------------------------------------------- --&gt;

&lt;style type="text/css"&gt;
/* 
This code highlights the last item in an incremental list 
Add 'class: highlight-last-item' or 'class: bold-last-item' to slide 
*/

.highlight-last-item &gt; ul &gt; li, 
.highlight-last-item &gt; ol &gt; li {
  opacity: 0.5;
}

.highlight-last-item &gt; ul &gt; li:last-of-type,
.highlight-last-item &gt; ol &gt; li:last-of-type {
  opacity: 1;
}

.bold-last-item &gt; ul &gt; li:last-of-type,
.bold-last-item &gt; ol &gt; li:last-of-type {
  font-weight: bold;
}

/* fixes positioning of double .pull-left[] on same slide */
.pull-right ~ * { clear: unset; }
.pull-right + * { clear: both; }
&lt;/style&gt;

&lt;!-- 
CSS Changes in CSS code chunks **and** inside of &lt;style&gt; tags apply to the **entire** document, indpendent of their location.
To apply changes only to the current slide, create new CSS class and put text into enclosing brackets.

Thus, &lt;style&gt; tags are NOT necessary for xaringan !!
--&gt;


&lt;!-- CSS Classes taken from Thomas Mock --&gt;
&lt;!-- https://github.com/jthomasmock/tidymodels-workshops/blob/master/tidymodels-intro-phil.Rmd --&gt;
&lt;!-- ----------------------------------------------------------------------- --&gt;

&lt;style type="text/css"&gt;
.hljs-github .hjls {
  background: black;
}

/* font size categories for text and code */
.size-60 {
  font-size: 60%;
}
.size-60 pre .remark-code {
  font-size: 60%;
}
.size-60 .remark-code {
  font-size: 60%;
}

.size-70 {
  font-size: 70%;
}
.size-70 pre .remark-code {
  font-size: 70%;
}
.size-70 .remark-code {
  font-size: 70%;
}

.size-80 {
  font-size: 80%;
}
.size-80 pre .remark-code {
  font-size: 80%;
}
.size-80 .remark-code {
  font-size: 80%;
}

.size-90 {
  font-size: 90%;
}
.size-90 pre .remark-code {
  font-size: 90%;
}
.size-90 .remark-code {
  font-size: 90%;
}

.size-100 {
  font-size: 100%;
}
.size-100 pre .remark-code {
  font-size: 100%;
}
.size-100 .remark-code {
  font-size: 100%;
}

.size-110 {
  font-size: 110%;
}
.size-110 pre .remark-code {
  font-size: 110%;
}
.size-110 .remark-code {
  font-size: 110%;
}

.size-120 {
  font-size: 120%;
}
.size-120 pre .remark-code {
  font-size: 120%;
}
.size-120 .remark-code {
  font-size: 120%;
}

.size-130 {
  font-size: 130%;
}
.size-130 pre .remark-code {
  font-size: 130%;
}
.size-130 .remark-code {
  font-size: 130%;
}

.size-140 {
  font-size: 140%;
}
.size-140 pre .remark-code {
  font-size: 140%;
}
.size-140 .remark-code {
  font-size: 140%;
}

.size-150 {
  font-size: 150%;
}
.size-150 pre .remark-code {
  font-size: 150%;
}
.size-150 .remark-code {
  font-size: 150%;
}

.remark-slide thead, .remark-slide tr:nth-child(2n) {
  background-color: white;
}
.remark-slide thead, .remark-slide tr:nth-child(2n) {
  background-color: white;
}

/* footer specifications */
div.my-footer {
    background-color: #1a1917;
    position: absolute;
    bottom: 0px;
    left: 0px;
    height: 20px;
    width: 100%;
}
div.my-footer span {
    font-size: 10pt;
    color: #F7F8FA;
    position: absolute;
    left: 15px;
    bottom: 2px;
}
&lt;/style&gt;


&lt;!-- Custom CSS Classes --&gt;
&lt;!-- ----------------------------------------------------------------------- --&gt;

&lt;style type="text/css"&gt;
.bold {
  font-weight: bold;
}

.underline {
  text-decoration: underline;  
}

.mono {
  font-family: 'Fira Mono', monospace;
}

/* make left and right column horizontally aligned */
.right-column {
  padding-top: 0;
}

/* 
The first two commands change the background of the input code block,
the repeated commands with the star change the background of the output code block

With special name .remark-code this is set as the new default, add custom prefix ( e.g. .grey-code-bg .remark-code) to leave the default unchanged
*/
.remark-code, .remark-code * {
    background-color: #f0f2f0;
}
&lt;/style&gt;


&lt;!-- Code Chunk Options --&gt;
&lt;!-- ----------------------------------------------------------------------- --&gt;




&lt;!-- Example First Slide for Link Footer --&gt;
&lt;!-- ----------------------------------------------------------------------- --&gt;

&lt;!-- layout: true --&gt;

&lt;!-- &lt;div class="my-footer"&gt;&lt;span&gt;text&lt;/span&gt;&lt;/div&gt; --&gt;

&lt;!-- this adds the link footer to all slides, depends on my-footer class in css--&gt;

&lt;!-- --- --&gt;



&lt;!-- here content of second slide --&gt;

## Motivation:&lt;br&gt;UK Covid-19 Crowd Forecasting Challenge

.footnote[ 
https://www.crowdforecastr.org/2021/05/11/uk-challenge/ &lt;br&gt;
https://epiforecasts.io/uk-challenge/
]

- Predict Number of Covid-19 Cases and Deaths for the next 4 weeks in the United Kingdom

--

- Submission of weekly predictions via an interactive web application

--

- Part of ongoing research project by the **epiforecasts** group of the London School of Hygiene &amp; Tropical Medicine that our project partner Nikos Bosse is actively part of due to his PHD in Epidemiology

---

## Motivation:&lt;br&gt;UK Covid-19 Crowd Forecasting Challenge

.footnote[ 
https://www.crowdforecastr.org/2021/05/11/uk-challenge/ &lt;br&gt;
https://epiforecasts.io/uk-challenge/
]

- Idea: Compare forecasts from humans with model-based predictions

--

- Empirically human forecasts are surprisingly competitive and in some cases even better than statistical models 

--

- This is mostly true for **point** forecasts, prediction **intervals** are often chosen too narrow, i.e. humans tend to be too confident in their own predictions

--

- Goal: Use valuable information from point forecasts and adjust prediction intervals / quantile forecasts with an appropriate correction procedure  

---

## Motivation:&lt;br&gt;UK Covid-19 Crowd Forecasting Challenge

.size-80[

<div id="htmlwidget-75ee0b112c948a3da76c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-75ee0b112c948a3da76c">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"59\" data-max=\"296447\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.01\" data-max=\"0.99\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"14.74\" data-max=\"700353\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","fillContainer":false,"data":[["GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB","GB"],["United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom"],["2021-08-14","2021-08-14","2021-06-05","2021-07-03","2021-06-26","2021-08-07","2021-08-14","2021-08-07","2021-08-07","2021-07-03","2021-07-03","2021-06-12","2021-07-10","2021-08-07","2021-07-24","2021-06-19","2021-08-28","2021-08-07","2021-08-21","2021-07-17","2021-06-19","2021-06-12","2021-06-26","2021-05-29","2021-06-19","2021-06-19","2021-07-24","2021-06-12","2021-06-05","2021-05-29","2021-06-19","2021-07-31","2021-06-19","2021-07-24","2021-09-11","2021-07-03","2021-08-07","2021-06-26","2021-07-17","2021-06-19","2021-06-19","2021-06-05","2021-06-05","2021-07-03","2021-07-03","2021-07-10","2021-06-12","2020-10-31","2021-07-24","2021-07-10"],["Cases","Deaths","Cases","Cases","Deaths","Cases","Cases","Cases","Cases","Deaths","Cases","Cases","Cases","Deaths","Cases","Cases","Deaths","Deaths","Cases","Deaths","Cases","Deaths","Cases","Deaths","Deaths","Cases","Deaths","Cases","Deaths","Cases","Cases","Deaths","Cases","Deaths","Cases","Cases","Deaths","Cases","Cases","Deaths","Cases","Deaths","Deaths","Cases","Deaths","Deaths","Deaths","Deaths","Cases","Cases"],[198759,613,30724,161805,119,185724,198759,185724,185724,118,161805,46825,210277,627,282920,62474,785,627,219919,284,62474,60,96843,59,74,62474,447,46825,61,20499,62474,524,62474,447,256051,161805,627,96843,296447,74,62474,61,61,161805,118,192,60,1810,282920,210277],[66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273,66022273],["2021-07-26","2021-07-19","2021-05-24","2021-06-28","2021-05-31","2021-08-02","2021-07-19","2021-08-02","2021-07-26","2021-06-28","2021-06-07","2021-05-24","2021-06-28","2021-08-02","2021-06-28","2021-06-07","2021-08-16","2021-07-26","2021-08-09","2021-07-05","2021-05-31","2021-05-24","2021-05-31","2021-05-24","2021-06-14","2021-05-24","2021-07-12","2021-06-07","2021-05-31","2021-05-24","2021-05-24","2021-07-12","2021-06-07","2021-07-12","2021-08-16","2021-06-14","2021-07-12","2021-05-31","2021-06-21","2021-06-14","2021-06-07","2021-05-24","2021-05-24","2021-06-07","2021-06-28","2021-06-28","2021-05-31","","2021-07-12","2021-06-28"],[0.2,0.975,0.75,0.95,0.4,0.5,0.6,0.2,0.025,0.85,0.8,0.75,0.05,0.6,0.85,0.99,0.95,0.1,0.01,0.025,0.95,0.5,0.5,0.1,0.975,0.9,0.7,0.4,0.7,0.05,0.5,0.65,0.45,0.7,0.7,0.2,0.4,0.35,0.01,0.75,0.35,0.1,0.99,0.65,0.05,0.95,0.15,null,0.85,0.6],[358216,1472,15680.5,160211.25281893,53.3139809031787,313696,700353,172153.703100676,187547.407952201,236,154277,12977.4567885138,161168.350927608,608.575796972502,340318,102796.123837998,861.650414443048,628.965402679239,109740.552274268,88.5337487377215,37165.3898964662,14.74,33639.5,21.3645872444149,182,51729.533262267,457,37854.2,83,8548,16405.3,798,54190.6670285252,433.048697099769,301851.841967782,43071.5582340918,839,25054.85,46116.8,174,61103.3,24.4814359136775,79,87107.1923727777,120.97247898844,222.914395793113,52.309553224961,null,427321.276956504,196420],["OMAC (Rt)","BQuilty (Rt)","seabbs (Rt)","BQuilty","NC","seabbs (Rt)","epiforecasts-EpiExpert","anonymous_Gnu","anonymous_Human","anonymous_Dunlin (Rt)","EuroCOVIDhub-ensemble","anonymous_Wasp","anonymous_Wasp","anonymous_Human","epiforecasts-EpiExpert_direct","pwhatfield","northofcam","anonymous_Human","BQuilty","BQuilty","anonymous_Dunlin","anonymous_Ruff","curlykale (Rt)","anonymous_Rail","anonymous_Dunlin (Rt)","anonymous_Dunlin","epiforecasts-EpiExpert","HCBarney (Rt)","epiforecasts-EpiExpert_direct","epiforecasts-EpiExpert_direct","seabbs","epiforecasts-EpiExpert_Rt","BQuilty","anonymous_Bison","anonymous_Human","anonymous_Dragonfly","Blitzer (Rt)","seabbs (Rt)","SneakyRodent (Rt)","EuroCOVIDhub-baseline","anonymous_Duck (Rt)","seabbs","epiforecasts-EpiExpert_direct","Mehopp","seb","RitwikP","anonymous_Raccoon","","d.simons","BQuilty (Rt)"],[3,4,2,1,4,1,4,1,2,1,4,3,2,1,4,2,2,2,2,2,3,3,4,1,1,4,2,1,1,1,4,3,2,2,4,3,4,4,4,1,2,2,2,4,1,2,2,null,2,2],["Unknown","Expert","Expert","Expert","Non-expert","Expert","Unknown","Expert","Expert","Non-expert","Unknown","Expert","Expert","Expert","Unknown","Non-expert","Non-expert","Expert","Expert","Expert","Non-expert","Expert","Non-expert","Expert","Non-expert","Non-expert","Unknown","Non-expert","Unknown","Unknown","Expert","Unknown","Expert","Non-expert","Expert","Expert","Unknown","Expert","Unknown","Unknown","Unknown","Expert","Unknown","Non-expert","Expert","Non-expert","Expert","","Expert","Expert"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>location<\/th>\n      <th>location_name<\/th>\n      <th>target_end_date<\/th>\n      <th>target_type<\/th>\n      <th>true_value<\/th>\n      <th>population<\/th>\n      <th>forecast_date<\/th>\n      <th>quantile<\/th>\n      <th>prediction<\/th>\n      <th>model<\/th>\n      <th>horizon<\/th>\n      <th>expert<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":4,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[4,5,7,8,10]}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

]

---

## European Forecast Hub

.footnote[https://covid19forecasthub.eu/index.html]

.left-column.size-80[

&lt;br&gt;
&lt;br&gt;

- UK Data only contains few observations over time span of 13 weeks

- European Forecast Hub provides data with forecasts from international research groups for many European Countries over a longer time horizon

] 

.right-column[
![](Images/european-forecast-hub.png) 
&lt;!-- &lt;img src="Images/european-forecast-hub.png" alt="" width="1000" height="500"&gt;   --&gt;
]


---
class: inverse, center, middle

# Post Processing 

---

## Idea

- Adjust Forecasts based on performance metrics on out-of-sample data

--

-  Split in 3 separate data sets:

    - **Training:** Build Forecast Model to make quantile predictions
    - **Validation:** Use predictions to determine potential hyperparameters of post-processing method
    - **Test:** Evaluate Adjusted Predictions compared to original predictions
  
--
    
- In our case the data already contains quantile predictions such that step 1 is not required

--

- **Important:** We do **not** build a prediction model ourselves. &lt;br&gt;
Instead we take existing predictions as input and output adjusted / processed forecasts.

---

## Methods

Many post-processing methods available, including

--

- **Conformalized Quantile Regression**: &lt;br&gt;
  Focus of Today

--

- **Quantile Regression Averaging**: &lt;br&gt;
  For given quantile level `\(\alpha\)`, new prediction is a weighted average of multiple existing predictions from different models. 
    The individual contributions, i.e. the weights, are chosen to minimize a chosen loss function.
    
--

- **Quantile Spread Adjustment**: &lt;br&gt;
  Assumes multiplicative relationship between quantile levels, e.g. `\(q_{0.9} = \lambda_{0.9} \cdot q_{0.8} = \lambda_{0.8} \cdot q_{0.8}\)` with potentially different factors `\(\lambda_{\alpha}\)`. &lt;br&gt;
  Too conservative quantile predictions can thus be corrected by choosing larger multiplicative factors in the tails of the predictive distribution. 

--

- More detailed overview given in **README** Page of Project's GitHub Repository&lt;sup&gt;1&lt;/sup&gt;

.footnote[[1] https://github.com/nikosbosse/post-processing-forecasts]

---


## Evaluation

- Based on **Weighted Interval Score**&lt;sup&gt;1&lt;/sup&gt; 

.center.bold[WIS = Sharpness + Underprediction + Overprediction]

.footnote[[1] https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008618]

--

- For a given quantile level `\(\alpha\)` and observed value `\(y\)`, the score is computed as

$$
Score_\alpha(y) = (u-l) + \frac{2}{\alpha} \cdot (l-y) \cdot \mathbf{1} (y \leq l) + \frac{2}{\alpha} \cdot (y-u) \cdot \mathbf{1}(y \geq u)
$$

--

- The Score of the entire model can be obtained from a weighted average over all (included) quantile levels `\(\alpha\)`  

--

- Implemented in the .mono[**eval_forecasts()**] function of the .mono[**scoringutils**] R package written by Nikos

---
class: inverse, middle, center

# Conformalized Quantile Regression

---

## Conformalized Quantile Regression

Theory based on Paper Romano Y., Patterson E., and Candès E. (2019): *Conformalized Quantile Regression*

**Central Theorem:** 

If `\((X_i, Y_i), i = 1, \ldots, n+1\)` are exchangeable, then the prediction interval `\(C(X_{n+1})\)` constructed by the CQR algorithm satisfies
  
$$
`\begin{aligned}
P \left(Y_{n+1} \in C(X_{n+1}) \right) \geq 1 - \alpha \quad \text{(coverage)}.
\end{aligned}`
$$
Moreover, if the conformity scores `\(E_i\)` are almost surely distinct, then the prediction interval is nearly perfectly calibrated:

$$
`\begin{aligned}
P \left( Y_{n+1} \in C(X_{n+1}) \right) \leq 1 - \alpha + \frac{ 1}{ \left| I_2 \right| + 1} \quad \text{(precision)}.
\end{aligned}`
$$

---

## CQR Algorithm

**Step 1:** &lt;br&gt;
Split the data into a training and validation (here called *calibration*) set, indexed by `\(I_1\)` and `\(I_2\)`, respectively

--

**Step 2:** &lt;br&gt;
For a given quantile `\(\alpha\)` and a given quantile regression algorithm `\(\mathcal{A}\)`, calculate lower and upper interval bounds on the training set:

$$
`\begin{aligned}
\left\{ \hat{ q}_{\alpha, \, low}, \; \hat{ q}_{\alpha, \, high} \right\} \leftarrow \mathcal{A} \left( \left\{ (X_i, Y_i): i \in I_1 \right\} \right) 
\end{aligned}`
$$

---

## CQR Algorithm

**Step 3:** &lt;br&gt;
Compute **conformity scores** on the calibration set:

$$
`\begin{aligned}
E_i := \operatorname*{max} \left\{ \hat{ q}_{\alpha, \, low}(X_i) - Y_i, \; Y_i - \hat{ q}_{\alpha, \, high}(X_i) \right\} \quad \forall \; i \in I_2
\end{aligned}`
$$

For each `\(i\)`, the corresponding score `\(E_i\)` is positive if `\(Y_i\)` is *outside* the interval `\(\left[ \hat{ q}_{\alpha, \, low}(X_i), \; \hat{ q}_{\alpha, \, high}(X_i) \right]\)` and negative if `\(Y_i\)` is *inside* the interval.

--

**Step 4:** &lt;br&gt;
Compute the **margin** `\(Q_{1 - \alpha}(E, I_2)\)` given by the `\((1 - \alpha)(1 + \frac{ 1}{ 1 + \left| I_2 \right| })\)`-th empirical quantile of the scores `\(E_i\)` in the calibration set.

---

## CQR Algorithm

**Step 5:** &lt;br&gt;
On the basis of the original prediction interval bounds `\(\hat{ q}_{\alpha, \, low}(X_i)\)` and `\(\hat{ q}_{\alpha, \, high}(X_i)\)`, the new *post-processed* prediction interval for `\(Y_i\)` is given by

$$
`\begin{aligned}
C(X_{n+1}) = \left[ \hat{ q}_{\alpha, \, low}(X_i) - Q_{1 - \alpha}(E, I_2), \; \hat{ q}_{\alpha, \, high}(X_i) + Q_{1 - \alpha}(E, I_2) \right].
\end{aligned}`
$$

--

Note that the **same** margin is subtracted/added for the lower and upper bound, which limits the flexibility of the classical CQR approach.

Possible extensions of the CQR principle could use different margins and/or **multiplicative** instead of additive correction terms.

---
class: inverse, center, middle

# The .mono[postforecasts] package 📦

---

## Core Idea

- Structured and unifying framework for implementing various post-processing techniques

--

- Aims to establish a consistent workflow for a collection of post-processing methods supported by an intuitive user interface 

--

- Allows for convenient comparisons between methods and the choice of the best method for the data of interest

---

## Overview of original Data

&lt;img src="first-presentation_files/figure-html/unnamed-chunk-4-1.png" width="100%" /&gt;

---

## Time Series Cross-Validation

.footnote[https://otexts.com/fpp3/tscv.html]

.pull-left[

- important point

- next important point

- very important point

]

--

.pull-right[

&lt;!-- ![](Images/cv-hyndman.svg){height=150%} --&gt;
&lt;img src="Images/cv-hyndman.svg" width="100%" /&gt;

]

---

## Adjust Predictions 

.size-90[


```r
model &lt;- "epiforecasts-EpiExpert"
location &lt;- "GB"

df_updated &lt;- update_predictions(
  df,
  method = "cqr", # ideally same interface for alternative methods
  models = model, # can be used for multiple models and locations
  locations = location,
  cv_init_training = 10
)

df_combined &lt;- collect_predictions(original = df, cqr = df_updated)
```

]

---

## Evaluate Predictions



.size-90[


```r
df_combined |&gt;
  filter_models(model) |&gt;
  filter_locations(location) |&gt;
* eval_forecasts(summarise_by = c("method", "model", "target_type")) |&gt;
  select(method, target_type:overprediction) |&gt;
  arrange(target_type, desc(method)) |&gt; 
  round_output(digits = 3)
```

```
##      method target_type interval_score sharpness underprediction overprediction
## 1: original       Cases      57099.758 10723.147       11290.552      35086.059
## 2:      cqr       Cases      51266.082 25772.255        3115.515      22378.312
## 3: original      Deaths         57.032    18.446          30.191          8.395
## 4:      cqr      Deaths         54.733    19.233          28.002          7.497
```

]

---

## Compare Predictions Visually

&lt;img src="first-presentation_files/figure-html/unnamed-chunk-9-1.png" width="100%" /&gt;

---
class: center, middle, inverse

# What's next?

---

## Many possible directions 

- Extension / Refinement of QCR Method with asymmetric and/or multiplicative approach

--

- Implementation of further Post-Processing methods

--

- Analysis of which methods perform best. 
Is this dependent on characteristics of the data such as sample size, forecast horizon or prediction model?

--

- Construct new Post-Processing method as Ensemble Model of individual processing techniques

---

## References

**Traditional CQR Method**

Romano Y., Patterson E., and Candès E. (2019). Conformalized Quantile Regression. *NeurIPS Annual Conference on Neural Information Processing Systems*.
  - Paper: https://proceedings.neurips.cc/paper/2019/file/5103c3584b063c431bd1268e9b5e76fb-Paper.pdf
  
  - Poster: https://github.com/yromano/cqr/blob/master/poster/CQR_Poster.pdf

&lt;br&gt;

**Variations and Extensions of CQR**

Tibshirani R. (2019). Advances and Challenges in Conformal Inference. *Carnegie Mellon University*.
  - Slides: www.stat.cmu.edu/~ryantibs/talks/conformal-2019.pdf

---

## References

**Theoretical Foundation of Weighted Interval Score** 

Bracher et al. (2021). Evaluating epidemic forecasts in an interval format.
  - Paper: https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008618
  
&lt;br&gt;

**Time Series Cross Validation**

Hyndman R., Athanasopoulos G. (2021). Forecasting: principles and practice, 3rd edition. *OTexts: Melbourne, Australia*.
  - Online Version: https://otexts.com/fpp3/

---

## References

**More Information about the UK Covid-19 Forecasting Challenge**

- Website: https://www.crowdforecastr.org/2021/05/11/uk-challenge/

- Evaluation &amp; Ranking: https://epiforecasts.io/uk-challenge/

&lt;br&gt;

**More Information about the European Forecasting Hub**

- Website: https://covid19forecasthub.eu/index.html

- GitHub: https://github.com/epiforecasts/covid19-forecast-hub-europe
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="https://platform.twitter.com/widgets.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current% / %total%",
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"ratio": "16:9",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
